<% layout('/layout/page') -%>

<table>
  <tr>
    <th>Name</th>
    <th>Capacity</th>
    <th>Delete</th>
  </tr>
<% for(var i=0; i<car.array_to_json.length; i++) {%>
	<tr>
		<th><%= car.array_to_json[i].name%></th>
		<th><%= car.array_to_json[i].capacity%></th>
		<th>
			<form id="form" action="">
				<button id="<%= car.array_to_json[i].id%>" onclick="console.log(<%= car.array_to_json[i].id%>)">Delete</button>
			</form>
			<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
			<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
			<script>
			  var socket = io();
			  $('#form').submit(function(){
			    socket.emit('chat message' + "<%= car.array_to_json[i].id%>", "<%= car.array_to_json[i].id%>");
			    return false;
			  });
			  socket.on('chat message', function(msg){
			    $('#messages').append($('<li>').text(msg));
			  });
			</script>
		</th>
	</tr>
<% } %>
</table>


<ul id="messages"></ul>
<form action="">
  <input id="m" autocomplete="off" /><button>Send</button>
</form>
<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script>
  var socket = io();
  $('form').submit(function(){
    socket.emit('chat message', $('#m').val());
    $('#m').val('');
    return false;
  });
  socket.on('chat message', function(msg){
    $('#messages').append($('<li>').text(msg));
  });
</script>
